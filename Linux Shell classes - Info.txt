Pwd: anirudh@123

Find and locate

find . -name "test*"

. - present working directory
-name - name of the file to search

if locate is not working do updatedb

locate filename

9422

/boot - Contains the file used by boot loader (grub.cfg
/root - Root user home directory, not same as /
/dev - System devices (eg disk, cdrom, speakers)
/etc - COnfiguration Files
/bin -> /user/bin  Everyday user commands
/sbin -> /user/sbin  - Syetm/Filesyetem Commands
/opt Optional add on applications (Not aprt of OS apps)
/proc Running processes (Only exist in Memory)
/lib -> /usr/lib  C programming library files needed by commands and apps
strace -e open pwd

/tmp - Temporary Files
/home - DIrectory for users
/var System Logs
/run System daemons that start very early *eg systemd udev) to stoe temporay runtime files like PID files

/mnt To mount external systems liek NFS

/media - For cdrom mounts

Wildcards

* represents 0 or more characters
? represents a single character
[] Represents a range of characters

Commnad to Open Image File in Linux

yum install ImageMagick -y
cd <path>
display <file-name>

Limux File types
- Regular File
d Directory
l link
c Special file or Device file
s socket
p Named pipe
b Block Device



More/Less Command

more will view one page at a time using spacebar

less will view in reverse, use j and k to go down or come up one line at at time

Cut Command

1. cut -c1 <file-name>  Fetches 1st characer from each line
2. cut -c1-3 <file> Range provided
4. cut -c1,3,5,7 <file> List provided
5. cut -d: -f 1 <file> Delimiter with fiels name
5 cut -d -f 1-2 <file> Fiels with Range
6. ls -l | cut -c2-3


Awk Cmmand

awk --version

awk '{print $1}' <file-name>
awk '{print $1,$3}' >filename>
awk '{print $NF}' <file>   - last Field
awk '/DMA/ {print}' <file>  - Search for a particular field
awk -F":" '{print $1'} >file-name>
cat <file> | awk {$2="Test";print $0}'  - Replace all 2nd fiels with word Test and prints
ls -l | awk '{if ($9 == "passwd") print}'  - Find those field where $9 == passwd
ls -l | awk '{print NF}'  - Number of fields

Gre[/Egrep

grep --version    - Versin Number
grep keyword file
grep -c keytword file  - Gives count of how many times word appears
grep -i Keyword FIle - Case Insensitive search
grep -n keyword - show match wih line numbers
grep -v keyword file - egt everything exceept the one given
egrep -i "Anirudh|Rakesh" <file>  - Searches more than one with a pipe


Sort

sort --version
sort -r file - Reverse Order
sort -k2 file - Starts from wnd file
uniq filename- Dooesnt remove duplicates, use it with sort 
sort <file> | uniq -c
sort <file> | uniq -d - Show only repeated lines

wc

wc - new line count, word count, byte count

wc -l - Lines
wc -w - Word
Wc -b - Byte count


tar 

tar cvf <file>.tar <files>
gzip <file>.tar  - Compress
gzip -d <file>.tar,gz -- Uncompress



truncate

if file is shorter it will append with characters, if larger will cut it


truncate -s 50 file 


Split  - Split on every 100 lines

split -l 100 <file> <new file>


Linux vs Windows Command
Listing dir ls -l
Rename ren mv
Copy copy cp
Move move mv
Clear Screen cls clear
Delete a file del rm 
Compare cotents fc diff
Search for a word find grep
Command help command /? man
Display current location chdir pwd
Display tiem time date


Vi editor

Esc - Command Mode
i - insert mode
save a file and press :wq! or SHift + ZZ

All in command mode
x - Cut on character
u - Undo operation
r- This will prepare to replace a character and then enter the charcter you want to replace with
o - Puts a new line below the line your cursor is and puts the prompt in Insert Mode
a - gives a new space from the cursor to write to next and puts prompt in insert mode
dd- Delete a line
To search put / and type the word
:q! - Exit

Shift + G - Go to end of the file


Sed command

Repalces a string with a new string.

sed 's/name/Name1/g' <file>   - Subsititutes but not replace in the file
use -i to insert in the file

Find and delete a line

sed '/Name/d' file

Remove Empty Lines

sed '/^$/d' new1


Remove the first line in a file

sed '1d' <filename> - Delete 1st
sed '1,2d' <filename> - Delete 1st n 2nd line
sed '$d' <file> - Delete the lsat line


To Replace Tabs
 sed 's/\t//g' <file>
 
 
 Show Defined lines
 
 sed -n 2,4p <file>  - Shows lines 2 to 4
 sed 2,4d <file>  - Shows alll except 2-4
 
 
 Put space after each line
 sed G <file>
 
 
 Substitute alll except a particular line
 sed '8!s/Name/name1/' <file>
 
 Replace in Vi
 :%s/Name/name1
 
 
 
 User Account Management
 
 Commands
 useradd
 groupadd
 userdel
 groupdel
 usermod
 
 Files
 /etc/passwd
 /etc/group
 /etc/shadow
 
 Example
 useradd -g superheros -s /bin/bash -c "user description" -m -d /home/spiderman spiderman.
 
 
 With root
 useradd spiderman
 groupadd superman
 
 userdel spiderman  - Doesnt delete home directory
 userdel -r spiderman - Delete home directory also
 
 
 groupdel <groupname>
 
 Add user to group
 useradd -G <group name> <user name>
 
 
 Modify the visudo file to add user to group or user to wheel to conduct sudo opertion
 
 
 Momitor users
 
 1. who - shows users logged in from all terminals
 2. last - all users logged in from inception time
 3. w  - just like who
 
 
 Talking to Users
 
1.  users - See all users logged in
 wall - To send message to all users
 
 
 
 Type message and press Ctl + D
 
 

 3. Write - Send message to one user
 
 write <user>
 
 
Difference Between Protocols

1. Active Directory = Microsoft
2. IDM = Identity Manager
3. WinBIND = Used in linux to COmmunicate with Windows (Samba)
4. OpenLDAP Open Source
5. IBM DIrectory Server
6. LDAP = Light Weight Directory Access Protocl - Used when any of the directory services like above are installed and it is not a directory services

Syetem Utility Commands

date 
uptime
hostname
uname
which <command name>
cal 
bc

Process and Jobs

Application = Service

Script Written in a file to execute

Process A process is an isntance of an application

Daemon Runs until Uninterrupted

Threads Every process could have multiple threads associated with it

Job - Run a service or process as a work order

Process/Service Commands
systemctl  - To start/stop an application, also used at boot time. ntp is replaced with chronyd in RHEL 7

syetemctl enable ntpd  - This will enable start at boot time and create a symlink

syetemctl enable ntpd



ps Check the process
top Gives top users utilizing the system
kill Kill a process
crontab Scehedule process
at
 
 
 Using Crontab
 
 Open crotab -e
 50 13 * 10 * echo "datta " > crontab_file
 
 50 - Minutes 
 13 - Hour
 * -  day of month
 10 - Month
 * - Day of week
 
 
 4 types of cron jobs
 
 Hourly
 
 Daily 
 Weekly
 
 Monthly
 
 All crons are in /etc/cron._   (type)
 The timing of each are in 
 
 /etc/anacrontab
 
 For Hourly
 /etc/cron.d/hourly
 
 
 Process Management
 Backgrounnd = Ctrl - z , jobs and bg
 Foreground - fg
 Run process even after exit - nohup process &
 OR nohup process > /dev/null 2>&1 &
 
 Kill a process by name = pkill
 
 Process priority = nice edg nice -n 5 process
 
 The niceness scale goes from -20 to 19, the lower the number the more the priority
 
 PRocess Monitoring = top
 
 List process = ps
 
 ---
 
 sleep 10  - Runs till returns the terminals
 Press Ctrl + Z
 
 do 
 jobs 
 
 shows the killed command
 
 Run bg
 puts the killed command bck to action in background
 
 run fg
 
 Brings the background process back to front
 
 ----
 
 System Monitoring
 
 top  - Shows all process
 df - Shows disk utilization
 dmesg - Gives the output of system warnign, errors
 iostat 1  - Gives all input and output stats

 netstat  - netstat -rnv
 free
 cat /proc/cpuinfo
 cat /proc/meminfo
 
 
 Log Monitoring
 
 /var/log
 bootchronyd-NTP
 cron
 maillog
 secure
 messages
 httpd
 
 
 System Maintenance Commands
 
 shutdown
 init 0-6
 reboot
 halt
 
 
 Changing System Hostname
 
 hostnamectl - set-hostname newhostname
 
 Version 7 = Edit /etc/hostname
 
 Version 6 = Edit /etc/sysconfig/network
 
 init 6  - reboot
 
Changing name on prompt requires reboot


Finding System Information

cat /etc/redhat-release
uname -a
dmidecode


System Architecture

32 bit vs 64 Bit

arch


Terminal Control keys

Ctrl + u - Clears everything on the line
Ctrl - c - Stop/Kill a Command
Ctrl + X - Suspend a command

Ctrl + D - Exit an interactive program

Terminal Commands


clear - Clear screen

exit - Exit command

script
Script command stores terminal activities on a log file

script <filename> - Logs the activity for that terminal for the user


Recover Root Password


reboot

Press e

rw init = /sysroot/bin/shadowctrl x
chroot /sysroot
passwd root
touch ./autorelabel
exit
reboot


 
 su password
 
 testing@123


SOS Report - To provide report for red hat case


sosreport

Enviornment Variable 

Envioronment variable is dynamic named value

printenv or env


To set enviornment variables

export var = <value>

To set enviornment variable permanently

vi .bashrc

var=value
export var

source .bashrc
to set global enviornmnent variable
vi /etc/profile or /etc/bashrc



------------

Module 6

Kernel - System which sits in the middle and interact with hardware

Shell - is like a container, interface between users and Kernel/OS
CLI is a shell


Find your shell
echo $0

Available in cat/etc/shells

Your shell - /etc/passwd

Types of Linux shells

Linux Installation with GUI
Desktop GUI enviornments with shells

Gnome 

KDE 

sh - Bourne Shell
bash - Bourne again shell
csh and tcsh shell
ksh - Korne Shell


Shell Scrpting

1. Shell (#!/bin/bash)
2. Comments #
3. Command echo, cp, grep etc
4. Statements (if, while, for etc)


Shell script should have exectuable permission
has to called from absolute path
if called from current location then
./script.bash

Basic Shell Scripts

Variable
a="value"


if-then-scripts

if [ condition ]

then 

logic

else
Logic

fi


For Loop

for x in `cat file.txt | awk '{print $1}'`

do

logic

done


Do while


#!/bin/bash
count=0

while [ $count -lt 10 ]
do
echo $count
sleep 1

count `expr $count +1`
done



Case Statement Scripts

case $choice in

a) date;;
b) ls;;

*) echo "Nothing"

esac


Aliases

On command line

alias l="ls -lrt"
l

alias pl="pwd;ls"
pl

In alias before putting $ sign put \ (baclk slash)


Creating User or GLobal Aliases

User = Applies to one user
Global = Applies to all

For User
Put in .bashrc file

FOr Global put in
/etc/bashrc


Hisory

history commnad

to run same history commands is 
!<command number>

FIle where your history command is stored in

/home/<name>/.bash_history



Module 7

Networking Services and System Updates

Change to Bridge Only Adaptor

and test the ping


Network Components

IP
Subnet mask
Gateway - Which route to send traffic out and where to send it, modem is like gateway
Static vs DHCP (Dynamic Host config prootocl)

Interface (has a MAC address)

MAC address mostly consist of ORagnizontally Unique IDentifier and Network Interface Controler

A subnet mask is a 32 bit number that masks an IP address and divides the ip address into network address and host addressm Subnet mask is made by setting all network bits to all 1 and setting host bits to 0



----


Network Files and Commands

1. Interface Defiantion
2. Assigning an IP address
3. Interface Configuration files

/etc/nswitch.conf
/etc/hosts
/etc/sysconfig/network
/etc/sysconfig/network-scripts/ifcfg-nic
/etc/resolv.conf   - DNS server

Static IP Defined in /etc/sysconfig/network-scripts/ifcfg-nic

Network Commands
ping
ifconfig
ifup  or ifdown
netstat  - netstat -rnv
tcpdump tcpdump -i <interface name>


---
NIC Information
Network Interface Card
NIC can have multiple ports

ethtool <interface>

Other NIC

Lo = Loppback device is a special interface that your computer uses to communicate with itselg. It is used mainly for diagnostics and trouble shottong and to connect to server running on local machine

virb0 = The virb0 or virtual bridge 0 interface is used for NAT. Virutal Environemtn sometime use to connect to outside world

NIC Bonding

NIC Bonding also known as network bonding. It can be defines as aggregation or combination of mul;tiple NIC into single bond interface
Main purpose is to provide high availability and redeundancy


modproobe bonding
modinfo bonding

Create /etc/sysconfig/network-scripts/ifcfg-bond0
Edit
/etc/sysconfig/network-scripts/ethenet1
/etc/sysconfig/network-scripts/ethernet2


bond0 would be like high availability
systemctl restart network



-------------

wget - Download packages from the web

wget <package>


curl

curl http://website.come/filena,each
curl -O http://gogole.com

https://the.earth.li/~sgtatham/putty/latest/putty-0.73.tar.gz

File Transfer

1. FTP
2. Scp
3. rsync



ftp


ftp <machine name>

Enter usernmae
Enter password
At the ftp prompt
ftp> put filemae

Daemon: vsftpd

 sftp localhost
The authenticity of host 'localhost (::1)' can't be established.
ECDSA key fingerprint is SHA256:Wk/7dUCxvjhQ6FI0h1ZDcQFVtAt7oqe1eHbwIReURiY.
ECDSA key fingerprint is MD5:52:8c:b6:c2:20:40:af:f4:82:19:a5:39:85:ba:90:e4.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'localhost' (ECDSA) to the list of known hosts.
root@localhost's password:
Connected to localhost.
sftp> put putty-0.73.tar.gz /tmp
Uploading putty-0.73.tar.gz to /tmp/putty-0.73.tar.gz
putty-0.73.tar.gz                             100%  306   336.8KB/s   00:00
sftp> exit


System updates and Repos

yum command isntall a package from repo defined in /etc/yum/repos.d

rpm (Red hat package manager)

Diff b/w yum and rpm

rpm used when you already have a package downloaded 

yum downoads it for you

To install package 

rpm -ihv <location of rpm>

rpm -e <package> - To remove the package


Syetm Upgrade/Patch

Minor upgrade can be done via yum

yum update -y

yum update vs upgrade
upgrade = delete packages and install new one

update=preserve old packages


--------Create local repository via DVD

Create a local diretory 
 will contain all packages

remove contents from yum.repos.d/
in yum.repos.d/
vi localrepo
--Contents

Save file
createrepo localrepo
then test yum install


---Advance Package management

To know more about package
rpm -qi <package name>

To know config files of the package
rpm -qc <package name>


To know if command is part of which package

which <command>
rpm -qf <output from above commnad>



----Roll Back and Updates

Virtual machine  - take Snapshot

Roll back package/patch

yum install <package -name>

yum history undo <id>


Rollback an update

Downgrading a systerm to minor version is not recommeded as might leave the syetm in undersirable or unstable state


yum update - will preserve them
yum upgrade - Upgrade will delete old packages


ssh and telnet

Telnet - Unsecured connection b/w computers
ssh = secured

Two types of package fr most services

Client Package
Server Package

systemctl stop sshd

systemctl start sshd

systemctl status sshd


DNS = Domain name system

Needs bind package

Hostname to IP   (A Record)
IP to hostname  (PTR Record)

Hostname to Hostname (cname record)

Files 

/etc/named.conf

/var/named


Service
systemctl start named

DNS listens on port 53

---
NTP

Purpose

Time Synchronization

File

/etc/ntp.conf

Service 

systemctl restart ntpd

Command 
ntpq > peers

Ntp port 123


---

Chronyd - daemon

Package name = chronyd
Config file - /etc/chrony.conf

Log file - /var/log/chrony

Serverice = systemctl start chronyd

COmmnad:

chronyc

DOnt run ntp and chronyd at the same time


---------
Sendmail

Files
/etc/mail/sendmail.mc
/etc/mail/sendmail.cf
/etc/mail/

Service
systemctl restart sendmail

Command
maill -s "Subject" xyz@domain.com

yum install sendmail
yum install sendmail-cf


---

Web server httpd

files
/etc/http/conf/httpd.conf
/var/www/html/index.html/


systemctl restart httpd
systemctl status httpd

Log file /var/log/httpd

systemctl stop firewalld



---Rsyslog

Purpose generate logs or collect lgs from other servers

Service or package name - rsyslog

/etc/rsyslog.conf

systemctl restart syslog
systemctl enable rsyslog


Linux OS Hardening

1. User Account
2. Remove unwanted packages
3. Stop un used services
4. Check on listening ports
4. Secure ssh config
5. Enable firwall
6. Enable selinux
7. Changing listening services port numbers
8. Keep your os upto date

User Account
Check when password expires

chage -l osboxes

For users
can /etc/login.defs

/etc/pam.d



Remove Unwanted packages

rpm -e <package name>


Stop Un used services

systemctl -a  - Shows all running services

Check on listening ports


netstat -tulnp


Enable firewalld
systemctl start firewalld

Iptables config 

/etc/systemctl.iptables-config

Enable Selinux

Security Enhanced Linux 

Know more about a file
stat <filename>



Open LDAP Instalaltion

Open source implementation of open directory services

Open Ldap Service
slapd

Start or stop service
systemctl start slapd
systemctl enable slapd

Config files
/etc/openldap/sladp.d/



Dependencies Resolved

======================================================================================================================================
 Package                                 Arch                      Version                              Repository               Size
======================================================================================================================================
Installing:
 compat-openldap                         x86_64                    1:2.3.43-5.el7                       base                    174 k
 openldap-clients                        x86_64                    2.4.44-21.el7_6                      base                    190 k
 openldap-devel                          x86_64                    2.4.44-21.el7_6                      base                    804 k
 openldap-servers                        x86_64                    2.4.44-21.el7_6                      base                    2.2 M
 openldap-servers-sql                    x86_64                    2.4.44-21.el7_6                      base                    151 k
Installing for dependencies:
 cyrus-sasl-devel                        x86_64                    2.1.26-23.el7                        base                    310 k
 unixODBC                                x86_64                    2.3.1-14.el7                         base                    413 k

Transaction Summary
======================================================================================================================================
Install  5 Packages (+2 Dependent packages)

Total download size: 4.2 M
Installed size: 12 M
Is this ok [y/d/N]: y
Downloading packages:
(1/7): compat-openldap-2.3.43-5.el7.x86_64.rpm                                                                 | 174 kB  00:00:00
(2/7): cyrus-sasl-devel-2.1.26-23.el7.x86_64.rpm                                                               | 310 kB  00:00:00
(3/7): openldap-clients-2.4.44-21.el7_6.x86_64.rpm                                                             | 190 kB  00:00:00
(4/7): openldap-servers-sql-2.4.44-21.el7_6.x86_64.rpm                                                         | 151 kB  00:00:00
(5/7): unixODBC-2.3.1-14.el7.x86_64.rpm                                                                        | 413 kB  00:00:01
(6/7): openldap-devel-2.4.44-21.el7_6.x86_64.rpm                                                               | 804 kB  00:00:01
(7/7): openldap-servers-2.4.44-21.el7_6.x86_64.rpm                                                             | 2.2 MB  00:00:02
--------------------------------------------------------------------------------------------------------------------------------------
Total                                                                                                 1.0 MB/s | 4.2 MB  00:00:04
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Installing : cyrus-sasl-devel-2.1.26-23.el7.x86_64                                                                              1/7
  Installing : unixODBC-2.3.1-14.el7.x86_64                                                                                       2/7
  Installing : openldap-servers-2.4.44-21.el7_6.x86_64                                                                            3/7
  Installing : openldap-servers-sql-2.4.44-21.el7_6.x86_64                                                                        4/7
  Installing : openldap-devel-2.4.44-21.el7_6.x86_64                                                                              5/7
  Installing : openldap-clients-2.4.44-21.el7_6.x86_64                                                                            6/7
  Installing : 1:compat-openldap-2.3.43-5.el7.x86_64                                                                              7/7
  Verifying  : openldap-servers-2.4.44-21.el7_6.x86_64                                                                            1/7
  Verifying  : openldap-servers-sql-2.4.44-21.el7_6.x86_64                                                                        2/7
  Verifying  : 1:compat-openldap-2.3.43-5.el7.x86_64                                                                              3/7
  Verifying  : unixODBC-2.3.1-14.el7.x86_64                                                                                       4/7
  Verifying  : openldap-devel-2.4.44-21.el7_6.x86_64                                                                              5/7
  Verifying  : cyrus-sasl-devel-2.1.26-23.el7.x86_64                                                                              6/7
  Verifying  : openldap-clients-2.4.44-21.el7_6.x86_64                                                                            7/7

Installed:
  compat-openldap.x86_64 1:2.3.43-5.el7      openldap-clients.x86_64 0:2.4.44-21.el7_6      openldap-devel.x86_64 0:2.4.44-21.el7_6
  openldap-servers.x86_64 0:2.4.44-21.el7_6  openldap-servers-sql.x86_64 0:2.4.44-21.el7_6

Dependency Installed:
  cyrus-sasl-devel.x86_64 0:2.1.26-23.el7                                unixODBC.x86_64 0:2.3.1-14.el7

Complete!


/etc/nsswitch.conf - tracks the user authentication

--------

Tracing Network Route (traceroute)

Command is used to map the journey that a packet of information undertake from source to destination. One use is to locate where data loss occurs through a newtwork 

Each hop in record reflects a new server o router b/w the source  n target reviweing results via traceroute helps

traceroute uses 33434

netstat -rnv - Shows kernel routing table

